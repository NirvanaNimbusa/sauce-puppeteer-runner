#!/usr/bin/env node

const { createWriteStream } = require('fs');
const path = require('path');
const child_process = require('child_process');

(async () => {
    const fd = createWriteStream(path.join(__dirname, '../puppeteer.log'));
    child = child_process.spawn('jest', ['--no-colors', ...process.argv.slice(2)]);

    child.stdout.pipe(process.stdout);
    child.stderr.pipe(process.stderr);
    child.stdout.pipe(fd);
    child.stderr.pipe(fd);

    await new Promise((acc) => {
        fd.close();
        child.on('exit', () => acc());
    });
})();
